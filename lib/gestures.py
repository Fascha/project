import math
import numpy as np


class GestureTemplate:
    def __init__(self, name, points):
        self.name = name
        self.points = points

    def __len__(self):
        return len(self.points)


class GestureRecognition:
    def __init__(self):
        self.gestures = []
        self.add_template(name='Swipe down', points=[(957, 249), (956, 251), (955.5343906859862, 252.1640232850345),
                                                     (954.238326573435, 255.40418356641248), (954, 256),
                                                     (953.4414523267023, 258.7927383664885),
                                                     (952.7570541960328, 262.2147290198361),
                                                     (952.0726560653633, 265.6367196731838), (952, 266),
                                                     (951.558866523236, 269.0879343373481),
                                                     (951.0653400126439, 272.54261991149303), (951, 273),
                                                     (950.2033500205845, 275.9210499245234),
                                                     (949.285133574274, 279.28784356099527),
                                                     (948.3669171279635, 282.65463719746714), (948, 284),
                                                     (947.6251885357224, 286.06146305352667),
                                                     (947.0009213920638, 289.4949323436487),
                                                     (946.3766542484053, 292.92840163377076), (946, 295),
                                                     (945.6477308422012, 296.3386227996355),
                                                     (944.7596104528606, 299.71348027913),
                                                     (943.8714900635199, 303.0883377586245),
                                                     (942.9833696741792, 306.463195238119),
                                                     (942.0952492848386, 309.8380527176135),
                                                     (941.2071288954979, 313.212910197108), (941, 314),
                                                     (940.3105277278057, 316.5855210207287),
                                                     (939.4113470649673, 319.95744850637254),
                                                     (938.512166402129, 323.32937599201637),
                                                     (937.6129857392906, 326.7013034776602),
                                                     (936.7138050764522, 330.073230963304),
                                                     (935.8146244136138, 333.44515844894784),
                                                     (934.9154437507755, 336.81708593459166),
                                                     (934.0162630879372, 340.1890134202355),
                                                     (933.1170824250988, 343.5609409058793), (933, 344),
                                                     (932.1876052126543, 346.9246212344446),
                                                     (931.2535925169049, 350.2870669391425),
                                                     (930.3195798211555, 353.6495126438404),
                                                     (929.385567125406, 357.0119583485383),
                                                     (928.4515544296567, 360.3744040532362), (928, 362),
                                                     (927.4299637678045, 363.7101086965867),
                                                     (926.3264049414222, 367.0207851757336),
                                                     (925.2228461150399, 370.33146165488046),
                                                     (924.1192872886576, 373.64213813402733),
                                                     (923.0157284622753, 376.9528146131742), (922, 380),
                                                     (921.9356687886576, 380.2701910876379),
                                                     (921.12736887085, 383.66505074242997),
                                                     (920.3190689530423, 387.05991039722204),
                                                     (919.5107690352347, 390.4547700520141),
                                                     (918.7024691174271, 393.8496297068062),
                                                     (917.8941691996195, 397.24448936159826),
                                                     (917.0858692818118, 400.6393490163903), (917, 401),
                                                     (916.6734853497742, 404.1018891771454),
                                                     (916.3081606365209, 407.57247395305114),
                                                     (915.9428359232677, 411.0430587289569),
                                                     (915.5775112100144, 414.51364350486267),
                                                     (915.2121864967612, 417.98422828076843), (915, 420),
                                                     (914.818555694359, 421.4515544451279),
                                                     (914.3857043105036, 424.9143655159715),
                                                     (913.9528529266481, 428.3771765868151),
                                                     (913.5200015427927, 431.8399876576587),
                                                     (913.0871501589372, 435.3027987285023), (913, 436),
                                                     (912.7476648907304, 438.77568620196485),
                                                     (912.4317169178286, 442.2511139038861),
                                                     (912.1157689449266, 445.72654160580737), (912, 447),
                                                     (911.6873103623265, 449.1888274637147),
                                                     (911.1937838517343, 452.64351303785963), (911, 454),
                                                     (910.5843317207863, 456.07834139606865), (910, 459),
                                                     (910, 459.5102405766499), (910, 461), (909, 461), (909, 462)])
        # self.add_template(name='Swipe up',
        #                   points=[(827, 471), (827, 468), (826.8351614664429, 467.3406458657714), (826, 464),
        #                           (825.9611709740004, 463.7670258440023), (825.3562407853402, 460.13744471204154),
        #                           (825, 458), (824.7033314777157, 456.51665738857855), (824, 453),
        #                           (823.989691685753, 452.90722517177693), (823.5833426869091, 449.25008418218187),
        #                           (823.1769936880652, 445.5929431925868), (823, 444), (823, 441.9230993274217),
        #                           (823, 438.24345264239366), (823, 436), (822.8101872525529, 434.5764043941466),
        #                           (822.323871458039, 430.92903593529246), (821.8375556635251, 427.2816674764383),
        #                           (821.3512398690112, 423.63429901758417), (821, 421),
        #                           (820.9433077077961, 419.97953874032856), (820.7391976339736, 416.3055574115243),
        #                           (820.5350875601512, 412.6315760827201), (820.3309774863287, 408.9575947539158),
        #                           (820.1268674125063, 405.2836134251116), (820, 403), (820, 401.6074881198547),
        #                           (820, 397.92784143482663), (820, 394.2481947497986), (820, 390.56854806477054),
        #                           (820, 386.8889013797425), (820, 386), (820, 383.20925469471445),
        #                           (820, 379.5296080096864), (820, 375.84996132465835), (820, 373),
        #                           (820, 372.1703146396303), (820, 368.49066795460226), (820, 364.8110212695742),
        #                           (820, 361.13137458454617), (820, 357.4517278995181), (820, 353.7720812144901),
        #                           (820, 353), (820, 350.092434529462), (820, 346.412787844434),
        #                           (820, 342.73314115940593), (820, 339.0534944743779), (820, 338),
        #                           (820, 335.37384778934984), (820, 331.6942011043218), (820, 328.01455441929375),
        #                           (820, 325), (820, 324.3349077342657), (820, 320.65526104923765),
        #                           (820, 316.9756143642096), (820, 313.29596767918156), (820, 311),
        #                           (819.9014169527032, 309.6198373378453), (819.6392529813972, 305.94954173956074),
        #                           (819.3770890100911, 302.2792461412762), (819.1149250387851, 298.60895054299164),
        #                           (819, 297), (819, 294.9334031016595), (819, 291.25375641663146),
        #                           (819, 287.5741097316034), (819, 285), (819, 283.89446304657537),
        #                           (819, 280.2148163615473), (819, 277), (819, 276.5351696765193),
        #                           (819, 272.8555229914912), (819, 269.1758763064632), (819, 269),
        #                           (819, 265.49622962143513), (819, 261.8165829364071), (819, 260),
        #                           (819.3653768618956, 258.173115690522), (820, 255), (820, 254.55630907994382),
        #                           (820, 252), (820.3552305413385, 250.93430837598453), (821, 249),
        #                           (821, 247.3592933700561), (821, 246), (821, 244), (821, 243.67964668502805),
        #                           (821, 243), (821, 242), (822, 242), (822, 241)])
        self.add_template(name='Swipe left', points=[(1071, 339), (1070, 339), (1065.3359977715754, 339), (1064, 339),
                                                     (1059.6719955431508, 339), (1059, 339),
                                                     (1054.05816550956, 338.2940236442229), (1052, 338),
                                                     (1048.415058898167, 338), (1042.7510566697424, 338), (1041, 338),
                                                     (1037.0870544413178, 338), (1031.4230522128933, 338),
                                                     (1025.7590499844687, 338), (1024, 338), (1020.0950477560441, 338),
                                                     (1014.4310455276195, 338), (1008.7670432991949, 338), (1004, 338),
                                                     (1003.1049019834164, 338.0577482591344),
                                                     (997.4526508096178, 338.42240962518594),
                                                     (991.8003996358192, 338.78707099123744),
                                                     (986.1481484620206, 339.15173235728895),
                                                     (980.495897288222, 339.5163937233405),
                                                     (974.8436461144233, 339.881055089392), (973, 340),
                                                     (969.1857438514685, 340.1315260740873),
                                                     (963.5251060440288, 340.3267204812404),
                                                     (957.8644682365891, 340.5219148883935),
                                                     (952.2038304291494, 340.7171092955466),
                                                     (946.5431926217097, 340.91230370269966), (944, 341),
                                                     (940.886776537354, 341.19457646641536),
                                                     (935.233804508742, 341.5478872182036),
                                                     (929.58083248013, 341.90119796999187),
                                                     (923.927860451518, 342.2545087217801),
                                                     (918.274888422906, 342.6078194735684),
                                                     (912.621916394294, 342.9611302253566), (912, 343),
                                                     (906.9668888253633, 343.2796172874798),
                                                     (901.3116071598142, 343.59379960223254),
                                                     (895.6563254942652, 343.90798191698525),
                                                     (890.0010438287161, 344.22216423173796),
                                                     (884.345762163167, 344.5363465464907),
                                                     (878.690480497618, 344.85052886124345), (876, 345),
                                                     (873.0306270465192, 345), (867.3666248180946, 345),
                                                     (861.70262258967, 345), (856.0386203612454, 345),
                                                     (850.3746181328208, 345), (849, 345), (844.7106159043963, 345),
                                                     (839.0466136759717, 345), (833.3826114475471, 345),
                                                     (827.7186092191225, 345), (822.054606990698, 345), (820, 345),
                                                     (816.3906047622734, 345), (810.7266025338488, 345),
                                                     (805.0626003054242, 345), (799.3985980769996, 345),
                                                     (793.734595848575, 345), (789, 345), (788.0705936201505, 345),
                                                     (782.4065913917259, 345), (776.7425891633013, 345),
                                                     (771.0785869348767, 345), (765.4145847064522, 345), (761, 345),
                                                     (759.7505824780276, 345), (754.086580249603, 345),
                                                     (748.4225780211784, 345), (742.7585757927538, 345), (740, 345),
                                                     (737.1283587413772, 345.44179096286507),
                                                     (731.5302192433722, 346.30304319332737), (727, 347),
                                                     (725.9517761098908, 347.2620559725273),
                                                     (720.4568868271782, 348.6357782932054), (719, 349), (716, 350),
                                                     (715.0000000000005, 350), (715, 350)])
        self.add_template(name='Swipe right',
                          points=[(672, 380), (673, 380), (675, 380), (678, 380), (678.6206227180982, 380), (684, 380),
                                  (685.2287702910718, 380.17553861301025), (691, 381), (691.7908003424291, 381),
                                  (698.4114230605272, 381), (703, 381), (705.0320457786254, 381),
                                  (711.6526684967235, 381), (718.2732912148217, 381), (724.8939139329199, 381),
                                  (731.514536651018, 381), (735, 381), (738.1339162448131, 381.0882793308398),
                                  (744.7519138150213, 381.2747017976062), (751.3699113852296, 381.46112426437264),
                                  (757.9879089554378, 381.6475467311391), (764.605906525646, 381.8339691979055),
                                  (771.2239040958542, 382.02039166467193), (777.8419016660624, 382.20681413143836),
                                  (784.4598992362706, 382.3932365982048), (791.0778968064789, 382.5796590649712),
                                  (797.6958943766871, 382.76608153173765), (804.3138919468953, 382.9525039985041),
                                  (806, 383), (810.9338458398767, 383), (817.5544685579748, 383),
                                  (824.175091276073, 383), (830.7957139941711, 383), (837.4163367122693, 383),
                                  (844.0369594303675, 383), (845, 383), (850.6575821484656, 383),
                                  (857.2782048665638, 383), (863.898827584662, 383), (870.5194503027601, 383),
                                  (877.1400730208583, 383), (883.7606957389564, 383), (890.3813184570546, 383),
                                  (892, 383), (897.0019411751528, 383), (903.6225638932509, 383),
                                  (910.2431866113491, 383), (916.8638093294472, 383), (923.4844320475454, 383),
                                  (930.1050547656436, 383), (936.7256774837417, 383), (940, 383),
                                  (943.3463002018399, 383), (949.966922919938, 383), (956.5875456380362, 383),
                                  (963.2081683561344, 383), (969.8287910742325, 383), (976.4494137923307, 383),
                                  (983.0700365104288, 383), (989.690659228527, 383), (991, 383),
                                  (996.3112819466252, 383), (1002.9319046647233, 383), (1009.5525273828215, 383),
                                  (1016.1731501009197, 383), (1019, 383), (1022.7937728190178, 383),
                                  (1029.414395537116, 383), (1036.0350182552143, 383), (1041, 383),
                                  (1042.6556409733125, 383), (1049.2762636914108, 383), (1052, 383),
                                  (1055.896886409509, 383), (1062, 383), (1062.5175091276074, 383), (1069, 383),
                                  (1069.1381318457056, 383), (1075, 383), (1075.758754563804, 383),
                                  (1082.3793772819022, 383), (1083, 383), (1085, 383), (1087, 383), (1088, 383),
                                  (1089, 383)])
        self.add_template(name='Circle counterclockwise',
                          points=[(931, 287), (930, 286), (928, 286), (925, 286), (923, 286), (919.1295009954639, 286),
                                  (919, 286), (916, 286), (913, 286), (908, 286), (906.8447884285547, 286), (901, 286),
                                  (894.5920359802063, 286.64079640197934), (891, 287),
                                  (882.493696914654, 288.7012606170692), (881, 289),
                                  (870.5598749088518, 291.61003127278707), (869, 292),
                                  (858.7339719682661, 294.9331508662097), (855, 296),
                                  (847.6245156418934, 300.02299146805814), (844, 302),
                                  (837.0062263159398, 306.19626421043614), (834, 308),
                                  (827.0970053784023, 313.4237814883982), (820, 319),
                                  (818.1921770828338, 321.7117343757493), (812, 331),
                                  (811.3161444002865, 331.88901227962754), (803.8260229542965, 341.62617015941447),
                                  (802, 344), (797.1312333177967, 351.9117458585803), (794, 357),
                                  (791.0305000993642, 362.5678123136921), (786, 372),
                                  (785.3865769785538, 373.47221525147097), (781, 384),
                                  (780.6066253658116, 384.7867492683768), (775.1127348890807, 395.7745302218387),
                                  (775, 396), (772.081658636944, 407.673365452224), (772, 408), (772, 419),
                                  (772, 419.9480253815451), (772, 432.23273794845426), (772, 433), (774, 443),
                                  (774.7083596921208, 444.113136659047), (781, 454),
                                  (781.3327400485518, 454.45751756675884), (788.5582602944808, 464.3926079049111),
                                  (789, 465), (796.6625558479291, 473.6203753289202), (797, 474), (803, 479),
                                  (806.249517969559, 481.2746625786912), (813, 486),
                                  (816.6176888841032, 487.8088444420516), (825, 492),
                                  (827.5573131706823, 493.3948980930994), (836, 498),
                                  (838.4222107506789, 499.1179434233903), (849, 504),
                                  (849.6237737587578, 504.1169575797671), (861.6980760652553, 506.38088926223537),
                                  (865, 507), (873.8265025587928, 508.3239753838189), (885, 510),
                                  (885.9862125079319, 510), (898.2709250748411, 510), (908, 510),
                                  (910.551702862447, 509.85823872986407), (922.81750131103, 509.17680548272057),
                                  (926, 509), (934.9859823444411, 507.5811606824567), (945, 506),
                                  (947.0955172157227, 505.5343295076172), (959.0876946616186, 502.86940118630696),
                                  (963, 502), (970.9109552548925, 499.56585992157153), (976, 498),
                                  (982.2977310573775, 495.03636185535174), (993, 490),
                                  (993.3799403904085, 489.74670640639437), (1003.6014390975611, 482.9323739349593),
                                  (1005, 482), (1013, 476), (1013.4544446048782, 475.6023609707316), (1021, 469),
                                  (1022.763528413739, 467.5891772690088), (1026, 465), (1030, 460),
                                  (1030.8435046588415, 458.48169161408543), (1035, 451),
                                  (1035.730721820914, 447.3463908954302), (1036, 446), (1036, 444), (1037, 439),
                                  (1037, 435.1873616364281), (1037, 427), (1037, 422.90264906951893), (1037, 418),
                                  (1035.3986055858647, 410.79372513639134), (1035, 409),
                                  (1030.3278559900098, 399.65571198001965), (1030, 399), (1026, 390),
                                  (1025.3084491546583, 388.44401059798116), (1022, 381),
                                  (1019.5168392501598, 377.6891190002131), (1016, 373),
                                  (1012.436986565492, 367.65547984823803), (1008, 361),
                                  (1005.4285072309824, 357.5713429746432), (999, 349),
                                  (997.96579622388, 347.81805282729147), (992, 341),
                                  (989.4542596879342, 339.0199797572821), (983, 334),
                                  (979.9083705973055, 331.29482427264236), (975, 327),
                                  (970.6246884109122, 323.249732923639), (968, 321), (965, 319),
                                  (960.9221137109172, 315.7376909687337), (960, 315), (952, 309),
                                  (951.0416064461429, 308.4523465406531), (945, 305), (941, 303),
                                  (940.1896824454693, 302.72989414848973), (935, 301), (930, 300),
                                  (928.2847125669089, 300), (926, 300), (923, 300), (922, 300), (920, 300), (918, 300),
                                  (917, 300), (916, 300)])
        self.add_template(name='Circle clockwise', points=[(906, 263), (906, 262), (907, 262), (909, 261), (912, 261),
                                                           (916, 260), (916.1858488780565, 260), (922, 260),
                                                           (927.6866168640564, 259.28917289199296),
                                                           (930, 259), (937, 259), (939.213636092106, 259), (946, 259),
                                                           (950.75865857328, 259), (958, 259),
                                                           (962.2888150996549, 259.35740125830455),
                                                           (970, 260), (973.5853140666602, 261.2804693095215),
                                                           (984, 265),
                                                           (984.4413251814685, 265.2036885452932),
                                                           (994.9237366875192, 270.04172462500884),
                                                           (997, 271), (1004.7033600820762, 276.13557338805083),
                                                           (1009, 279),
                                                           (1013.6888571770066, 283.3281758556985), (1022, 291),
                                                           (1022.1299775925502, 291.1949663888253),
                                                           (1028.534003828282, 300.8010057424232),
                                                           (1030, 303), (1033.9811671144928, 310.9623342289856),
                                                           (1036, 315),
                                                           (1037.6284717929434, 321.8395815303619),
                                                           (1040.302535987793, 333.07065114873024), (1041, 336),
                                                           (1042.1278570008842, 344.45892750663194), (1043, 351),
                                                           (1043, 355.94606326214534), (1043, 364),
                                                           (1042.6345364412266, 367.47190380834724),
                                                           (1041.425948250529, 378.953491619975),
                                                           (1041, 383), (1039.287665860244, 390.277420093963),
                                                           (1037, 400),
                                                           (1036.6223888114696, 401.5104447541213), (1034, 412),
                                                           (1033.6365105443565, 412.6361065473761), (1030, 419),
                                                           (1027.9085753472411, 422.6599931423281), (1026, 426),
                                                           (1021.9654110769166, 432.5562070000106), (1018, 439),
                                                           (1015.4528017607607, 442.0566378870871), (1013, 445),
                                                           (1009, 448),
                                                           (1006.6988517472912, 449.438217657943), (1001, 453),
                                                           (996.684688437534, 455.157655781233), (993, 457), (987, 459),
                                                           (985.9455671164626, 459.3163298650612), (977, 462),
                                                           (974.816590935816, 462.3119155805977), (970, 463),
                                                           (963.372049269745, 463.8284938412819), (962, 464),
                                                           (954, 465),
                                                           (951.912806512975, 465.2319103874472), (945, 466),
                                                           (940.4103247810941, 466),
                                                           (932, 466), (928.8653022999201, 466), (919, 466),
                                                           (917.3332508250724, 465.79165635313404), (911, 465),
                                                           (906.0361471257303, 463.5817563216372), (897, 461),
                                                           (894.950456962737, 460.3595178008553),
                                                           (883.9309641584921, 456.9159262995288),
                                                           (881, 456), (872.8243232084005, 453.7702699659274),
                                                           (870, 453),
                                                           (861.9012867593004, 450.0550133670184), (859, 449),
                                                           (851.4350521982394, 445.2175260991197), (849, 444),
                                                           (841.2877025354325, 439.7153902974625), (840, 439),
                                                           (833, 433),
                                                           (832.4543073029498, 432.34516876353973), (828, 427),
                                                           (825.4554947652307, 423.1832421478461), (824, 421),
                                                           (821.1789030135025, 412.5367090405073), (821, 412),
                                                           (818, 403),
                                                           (818, 401.50755150226667), (818, 394),
                                                           (818, 389.9625290210927),
                                                           (818, 384),
                                                           (818, 378.4175065399187), (818, 375), (819, 367),
                                                           (819.007206561837, 366.9351409434661), (820, 358),
                                                           (820.7018837833081, 355.5434067584218),
                                                           (823.8735453809368, 344.4425911667213),
                                                           (824, 344), (827, 334),
                                                           (827.2037816662928, 333.38865500112144),
                                                           (830, 325),
                                                           (831.6215622269232, 322.8379170307691), (836, 317),
                                                           (837.8995961819828, 313.2008076360344), (839, 311),
                                                           (844, 305),
                                                           (844.9523452657609, 304.1534708748792), (853, 297),
                                                           (853.6470214192937, 296.56865238713755), (859, 293),
                                                           (863.5719029560305, 290.71404852198475), (865, 290),
                                                           (874.2368217158394, 286.3052713136642), (875, 286),
                                                           (883, 282),
                                                           (884.6875011572455, 281.43749961425146), (886, 281),
                                                           (891, 280),
                                                           (896.0234144024183, 279.3720731996977), (899, 279),
                                                           (907.4074364312348, 277.47137519432096), (910, 277),
                                                           (916, 277),
                                                           (918.909955037652, 277), (921, 277), (926, 277), (930, 277),
                                                           (930.454977518826, 277), (933, 277), (936, 277), (938, 277),
                                                           (940, 277),
                                                           (942, 277)])
        self.add_template(name='Z_shape',
                          points=[(15.134802781347428, 1.1559035807171218), (19.10016421543736, 1.2767105188330823),
                                  (23.219922977951025, 2.0666631261229576), (27.402977378428183, 2.641439469809928),
                                  (31.65193577119938, 2.4013948987642046), (35.89267162126355, 2.3595437780371076),
                                  (40.14622733462104, 2.678390775139845), (44.40365604221242, 2.8406783908607243),
                                  (48.660323117468515, 2.864483375528899), (52.90156818527476, 2.1823982229346015),
                                  (57.14605773590029, 2.07870732240755), (61.37862629633965, 1.3712409783646387),
                                  (65.61465527840456, 1.2632866573499637), (69.8678657008387, 1.221577605420321),
                                  (74.02386842676682, 0.33597802663224735), (78.19083081852482, 0.0),
                                  (79.17156630651505, 3.44645231402995), (76.46430885910432, 7.310826137624915),
                                  (73.0336360465371, 11.498316647171688), (69.38228412709189, 15.354019318190216),
                                  (65.72376139082401, 18.943750426504362), (61.97842471820093, 22.328768553636614),
                                  (58.481125074750075, 26.5026694806315), (54.86462255656523, 30.38095969904939),
                                  (51.37959471245473, 34.55086696428374), (47.91329799680377, 38.796122312936454),
                                  (44.72967541515082, 43.78369223163049), (41.474449902427416, 48.04723965400541),
                                  (37.868491442798444, 52.03999829510575), (34.23583461484417, 55.979125662213804),
                                  (30.75296155264833, 60.29689772967521), (27.17663336704873, 64.30876278633394),
                                  (23.73091333451564, 68.69117464672577), (20.418559089288486, 73.23782771327963),
                                  (16.700394624975644, 76.86801131842), (13.320452538815207, 80.80810302493907),
                                  (9.554907547308492, 83.94242217844916), (5.740430854330997, 87.01488017536165),
                                  (2.580727453730107, 91.4582847865763), (0.0, 96.82968632158753),
                                  (2.3759471188833072, 100.0), (6.607229934541478, 99.92207317549193),
                                  (10.820860725570544, 99.36976230445781), (15.033431471753776, 98.34211750305779),
                                  (19.26447491177577, 97.55596734168624), (23.51395087567537, 97.29300654828772),
                                  (27.758740022891548, 97.22678156914597), (32.01088732218604, 96.93076594665754),
                                  (36.248996287745605, 96.1899788030177), (40.49571534605387, 95.68718896510677),
                                  (44.74257971500748, 95.7525215757404), (48.96707279119895, 95.63105905260683),
                                  (53.21746797357956, 95.32182562488664), (57.467760580848946, 95.25439083814823),
                                  (61.71297859627654, 94.93059106102524), (65.97109042558604, 94.85365649463002),
                                  (70.22940478017327, 94.901090798063), (74.47997224734499, 95.04822587386101),
                                  (78.72457238095258, 95.45779723014769), (82.98057150703083, 95.61758719428568),
                                  (87.23781566418661, 95.7202074628524), (91.49596367847688, 95.62272559371162),
                                  (95.74881865664284, 95.78316598251364), (100.0, 96.20471103782768),
                                  (100.0, 96.20471103782768)])
        self.add_template(name='M_shape',
                          points=[(1.2079947891402925, 99.44938617076386), (0.16454815688946373, 96.8507766758905),
                                  (0.0, 90.93858142859432), (0.5259825312881211, 84.99624430012955),
                                  (0.7515534069820666, 78.87836960751733), (1.2074701419514124, 72.86781051377562),
                                  (1.2618196063579823, 67.1763318080401), (1.8457856056380342, 61.6041949343633),
                                  (2.2719914657968245, 55.75042669502455), (2.869086508754168, 49.90648715654143),
                                  (3.13372303458454, 43.82008505911837), (3.016725497266514, 37.818201095880355),
                                  (3.0075942741241453, 31.751757725289888), (2.7520454420751292, 25.618840415036846),
                                  (3.097601719960987, 19.758846376580173), (3.248497360265495, 13.953679469577079),
                                  (3.645842951105208, 7.901822711294547), (4.643691561641836, 2.158413270172135),
                                  (8.8097390285584, 0.0), (13.058508999784287, 2.992808174114079),
                                  (16.563085398752612, 7.2267151295819305), (20.95843446542695, 11.093266387580938),
                                  (24.02504654841317, 15.845767263095404), (28.232749900854387, 20.22871108136384),
                                  (31.12130342576827, 25.054701977307715), (33.44080767014168, 30.025541198256114),
                                  (36.29898043921273, 34.65533924887549), (38.675111712665256, 39.57804321093704),
                                  (40.10049564858163, 45.40829936313759), (41.1616294608451, 50.889535758925426),
                                  (43.08709078870176, 56.264562203692726), (43.05976549913403, 61.00823246953684),
                                  (46.20493322710279, 63.8213018815071), (47.01463352636794, 58.3191082756044),
                                  (49.05229628283361, 52.69644532624933), (51.21314727519854, 47.53577233952869),
                                  (54.802368337573775, 42.6414985799268), (59.2950440414082, 38.65154603474792),
                                  (63.576056784027784, 34.31412851154914), (67.07973846070283, 30.059378026579815),
                                  (70.97396070379797, 25.421810040197865), (74.85785565747707, 21.339556343315376),
                                  (79.23310433414704, 17.358904041290863), (83.36879072756899, 13.026505265308472),
                                  (88.00702726012658, 9.51822089388378), (92.562431945252, 6.508147234825932),
                                  (96.92840028995948, 6.168020146910216), (98.83230745296576, 10.769921393405607),
                                  (99.99999999999999, 16.657794939622676), (99.73978007462769, 22.158066039426625),
                                  (99.84345967591422, 27.621702582718317), (98.302180912656, 33.34562745531558),
                                  (98.28659397597701, 38.84835288855234), (96.47923546615999, 44.62156080475727),
                                  (95.1126336832844, 50.60171705141207), (94.31096281608716, 56.72940753751592),
                                  (92.52711863988857, 62.47552327310776), (91.44492063812615, 68.34015276359202),
                                  (90.78344922206243, 74.33483645829527), (91.19640580601724, 80.15852071548096),
                                  (90.48735811353494, 85.59144619058591), (91.64161619109821, 90.23769649952283),
                                  (91.32626897851343, 94.75258479891353), (92.02129905175005, 100.0),
                                  (92.02129905175005, 100.0)])
        self.add_template(name='C_shape',
                          points=[(927.3265755712681, 157.30531882234018), (930.69981772368, 160.2238924615599),
                                  (930.69981772368, 160.2238924615599), (932.0938306001397, 158.97418863802577),
                                  (929.3777373922637, 157.53971437208148), (930.6915142925513, 154.85104810364982),
                                  (928.5742149052488, 154.86044611540396), (926.0885592223069, 154.8714791424124),
                                  (923.8328530319181, 154.67300423735992), (924.9399383805245, 153.17941125872758),
                                  (921.633330805641, 153.41948828226745), (917.1665812479739, 152.36462794567643),
                                  (916.6248080303228, 152.2366836606098), (914.6226370301924, 151.8138602809721),
                                  (911.3146938229887, 152.0574086709907), (909.3112352422716, 151.83009349966505),
                                  (907.1891439770922, 152.08718553737162), (903.6003898953405, 152.10831892909232),
                                  (902.7499999216567, 152.15264352849266), (898.4094298095531, 152.3788856495688),
                                  (893.2880083599619, 153.7058435722802), (891.1179207660965, 154.89044196622598),
                                  (888.795712055115, 155.51537809945015), (886.1545645965236, 156.22614473822887),
                                  (882.5385981134718, 156.70032223398502), (880.5764886083175, 156.46969207089322),
                                  (879.7238316469462, 159.43645216831268), (876.7008590712185, 159.45417680809058),
                                  (876.6558551270679, 159.46644716935984), (871.7442530272295, 160.80559939953196),
                                  (868.1310343508402, 161.29790932798315), (865.8804483655107, 164.02494190806823),
                                  (863.6396431068512, 164.04511608840517), (862.2975239952553, 164.05719931290062),
                                  (858.730689626285, 166.9956430398191), (856.4390985791593, 167.28888940103633),
                                  (851.7611750835708, 168.40981872385515), (850.3339170819855, 168.49910172751208),
                                  (846.4834800916955, 168.73996818578587), (841.5451524338276, 170.1248647406212),
                                  (839.0793706768269, 171.97690767533854), (836.7125940960432, 172.5845221745909),
                                  (832.4620401009817, 173.67575244035567), (827.5357218319635, 175.07617541193406),
                                  (825.0392538361476, 175.9414857735948), (822.8148661160757, 176.73625370211386),
                                  (818.1318099293347, 178.40949745862684), (813.2505258543607, 179.85693733937543),
                                  (808.9960187908122, 181.1607857875867), (808.7440404952558, 181.23800777940306),
                                  (803.887079622091, 182.69650596256815), (796.7357612222321, 183.32969604067026),
                                  (795.0911707893988, 184.46803300282076), (793.2321826501673, 185.7547697299955),
                                  (789.2130327138391, 186.4283798276392), (784.1487476620522, 188.85271933432563),
                                  (781.6020796732927, 189.14554964248723), (778.5518427983791, 189.4962831530937),
                                  (773.7739942907205, 191.00057531046073), (770.2759871005628, 193.95638997311266),
                                  (768.6140487026452, 194.78077213729313), (766.6675699378245, 195.74629671912157),
                                  (764.441620630461, 198.477791014999), (759.567166653131, 200.50982635456654),
                                  (756.5122948901283, 202.2920099414585), (754.9733223929433, 203.1898320884887),
                                  (752.7566188383329, 205.9151961471448), (745.7370909779773, 208.03520565059256),
                                  (744.2994295068804, 209.25707799158113), (742.2532936321988, 210.99609436048348),
                                  (737.393587118062, 213.96634978648973), (733.4242774188154, 217.0382897524511),
                                  (732.4191517008591, 217.5189839038949), (728.468122924157, 219.4085350229413),
                                  (723.7245679564702, 223.74413991209275), (722.7817545623698, 225.70819617142718),
                                  (721.538041693879, 226.59849897522543), (716.7062310070967, 230.0573154841233),
                                  (711.022625865914, 233.07891093865308), (709.4813647105937, 234.55646583652825),
                                  (707.8308059302431, 236.13880066779248), (700.421398385161, 240.5303133461609),
                                  (698.009669062095, 243.22271799100014), (697.3625760015636, 243.9451192759017),
                                  (693.0638975571578, 248.73048159849722), (687.8542054246639, 252.53399621054947),
                                  (687.302764992471, 252.89909060541237), (683.8794286118556, 255.16559275383617),
                                  (677.8133881294996, 260.0184495799214), (675.5687604389428, 261.408539891422),
                                  (671.3544527572262, 264.01844633723607), (667.5386263974641, 268.8604559595534),
                                  (665.4966345638853, 271.56932715365997), (663.6118456903015, 274.06965560878194),
                                  (657.7815745899934, 279.15940354179304), (655.4545138826553, 281.96319266697554),
                                  (653.1479764388387, 284.74225407324076), (646.7228353034509, 288.95296815526535),
                                  (644.9378774063551, 291.63376087397756), (642.532191521123, 295.24681259644814),
                                  (638.4659625654544, 300.6527202150157), (636.42256799383, 303.381471521835),
                                  (634.4265871095073, 306.04690653967987), (628.7942673395204, 311.193075637217),
                                  (628.1551085234261, 314.6901014033258), (627.8016739372633, 316.62384591771337),
                                  (627.4538570873248, 322.554875751204), (624.1396938741226, 328.27075187259135),
                                  (624.1212672235202, 328.3025319767683), (623.18065253597, 335.20650779783193),
                                  (622.3838135129449, 341.5110295632468), (622.1900060577982, 342.6496660690592),
                                  (621.4205028181863, 347.1705679058831), (619.837974190024, 354.6132542125401),
                                  (619.9395195513238, 356.93021990920283), (620.0840777866381, 360.22861254975777),
                                  (621.5916185083183, 366.41785083038087), (622.7859862246795, 371.1106802861347),
                                  (623.3793418073473, 373.4420532108506), (622.9247184918764, 378.9632877062486),
                                  (624.0307638136817, 384.93963981344746), (624.1559101776277, 385.41414496621746),
                                  (625.8268071011307, 391.7495204014296), (624.8234455739403, 398.6501115767756),
                                  (625.2510635321487, 399.5419052518324), (626.7597047809088, 402.6881639571755),
                                  (628.0035330708789, 410.28543141236787), (628.2942625187671, 413.5992119831165),
                                  (628.4830062648656, 415.7505432748529), (628.7237069024695, 421.3157994752707),
                                  (630.1401253250467, 426.4865110770881), (630.2219455281514, 427.9070842653076),
                                  (630.3528278743124, 430.1794808704536), (630.5935539339357, 435.73250959065234),
                                  (629.6771935873592, 439.45713444586846), (630.528294665879, 442.1708849694017),
                                  (631.0975289844253, 443.9858984489458), (632.5043556966074, 449.1223461272886),
                                  (632.6852680720392, 453.38820316923227), (632.8468760639973, 456.40055846676967),
                                  (632.9295123737937, 457.94089024472026), (634.7432108503089, 461.5687157692771),
                                  (633.7039603602543, 466.60744149710365), (635.4623907456918, 469.9432687922167),
                                  (635.6419943678748, 470.28398553036055), (637.1019223934738, 475.3286976631527),
                                  (636.0867142997471, 479.9462436434698), (637.4397818162892, 483.5835974394758),
                                  (637.6268235312518, 483.7763918459691), (640.5222155976217, 486.76083515645064),
                                  (641.2267462878801, 491.32323683487164), (644.295604267672, 494.9337371420312),
                                  (644.4568476276403, 495.92170040342944), (644.8836451976645, 498.5367558036691),
                                  (647.9795684120406, 501.69361762664727), (649.2242103566841, 503.9747476809567),
                                  (652.7570310743919, 506.6284210055573), (653.0627629265182, 506.9249004485421),
                                  (656.4466511372199, 510.2063815400732), (656.9767090307607, 513.4040127909076),
                                  (660.5078371239841, 516.0610087582414), (662.2225079588969, 517.3416552916874),
                                  (662.7912192897486, 517.7664121485471), (667.4048142179921, 519.9576975389137),
                                  (670.2342952347717, 523.0543460242137), (674.2188887596009, 525.1501547283984),
                                  (674.4389869963684, 525.2659215682326), (679.0569005361817, 526.9576158596466),
                                  (682.5639766187558, 529.6090733175715), (685.3564637647784, 533.2212289859676),
                                  (685.7216799246982, 533.3436953624648), (691.7678854924754, 535.3711436758299),
                                  (695.5585720961552, 538.5498002019295), (698.0952906304415, 540.4841217055538),
                                  (699.0486127989146, 541.2110575265507), (704.6045147301362, 543.8835640796723),
                                  (711.0922981412338, 546.8889323136923), (712.1046238480579, 547.3578769946395),
                                  (714.337272707043, 550.594346698297), (718.8010497723997, 553.5321894070615),
                                  (721.6123802228492, 556.5478860883369), (722.1919976002036, 557.1696380424759),
                                  (727.9485591360135, 559.8371062823793), (731.4730969259554, 563.6495310922958),
                                  (733.1871182728426, 564.9100155737383), (734.9652736140407, 566.2176639395215),
                                  (740.6805198803461, 568.4358042287853), (742.866178236379, 571.730037948906),
                                  (744.8788283674174, 572.6739879316035), (746.4553887702334, 573.4134081328642),
                                  (749.9162783381191, 576.0846158410994), (754.6858830862993, 578.0894543296821),
                                  (757.7697481334584, 579.0404075023978), (759.3501119500025, 579.5277349186127),
                                  (763.6840912444894, 580.1418780948787), (767.1068705055011, 580.0937192305803),
                                  (771.7040216428803, 582.2078985000495), (772.4163784079067, 582.5355035450173),
                                  (775.8439518076898, 582.4893041273283), (778.8255195237539, 582.6906508859573),
                                  (783.1466957121576, 581.7151263250041), (786.0304568105383, 581.6828419515153),
                                  (786.5747428510331, 581.676748543214), (790.0030510470264, 581.6383678388287),
                                  (794.8091823729849, 581.5930979479486), (798.2382539288071, 581.5547086652522),
                                  (800.3403789466145, 580.607411691595), (800.8745078932682, 580.3667130031623),
                                  (803.419720492803, 580.7544134490937), (806.8484209188852, 580.720846459278),
                                  (809.7454484963004, 578.2322008859511), (813.1710569417082, 578.2014041998556),
                                  (813.7913127161511, 577.9227736531136), (815.2856815507657, 577.2514750976156),
                                  (821.3952007565738, 575.8912993852232), (819.2902151764996, 574.9218895191627),
                                  (823.548873774198, 574.3315465857902), (824.0682874161282, 574.2595445302188),
                                  (827.4981628836629, 574.233410299471), (829.4659092973966, 572.6714720365079),
                                  (831.7748514443554, 572.2514446399081), (835.2045247882154, 569.4994899697332),
                                  (836.5015024279847, 569.6289879331696), (839.2487961344999, 569.9032940808211),
                                  (843.5310920943205, 567.9417115666778), (847.5876637859308, 568.3516552250115),
                                  (850.4839680228042, 567.7133338001495), (851.7054980985974, 567.4441187057663),
                                  (856.5021068384887, 566.8018254160302), (861.3716987614278, 566.7948066528672),
                                  (864.9200994604491, 566.9998847064734), (866.2281095516701, 567.0754804991578),
                                  (868.9897703836724, 566.6401263608489), (872.4228610536799, 566.6339607816578),
                                  (878.6298675119602, 566.5353021195554), (879.397207271658, 566.5348556774911),
                                  (882.0653365445875, 566.5333033466949), (884.1316678256785, 567.2782054202272),
                                  (889.0019306636223, 567.2902114872264), (891.1168257427163, 566.4552122811878),
                                  (893.6223390756701, 566.4578513324191), (894.5521700950376, 566.4588307212191),
                                  (899.368329093588, 565.8555957186694), (902.8050334325345, 565.8612835393784),
                                  (904.9191068417917, 565.0442892985714), (907.9237483868773, 564.6737274608612),
                                  (909.7383054058816, 564.4499385085011), (913.1760736468972, 564.460470340645),
                                  (913.8814414702849, 563.1056682373359), (916.717717733599, 562.3517553194907),
                                  (921.467913997098, 561.7682262479581), (921.5422266516206, 561.7590974474009),
                                  (922.9140547063088, 561.3874560511085), (925.0458387326186, 560.367925129301),
                                  (925.7557284739811, 559.0223718812222), (929.8368687541574, 558.6799385131338),
                                  (933.3443330784256, 557.3070283325295), (934.5616245757911, 556.9393942123816),
                                  (935.7996345795832, 556.5655028975539), (938.2458996501118, 556.1691821482859),
                                  (940.3690722024558, 555.4089780206994), (943.4669658038275, 553.4391613611484),
                                  (945.1842120819935, 553.4617593210409), (947.8773744650466, 553.0400821105644),
                                  (948.1995007572442, 553.2283941989399), (948.6289638996311, 553.4794544296074),
                                  (948.2865392841782, 553.1256646904927), (952.1444916792511, 552.1332898598035),
                                  (952.1444916792511, 552.1332898598035), (954.0942492479294, 552.1340851036696),
                                  (954.8563509754812, 552.5755208844704), (956.5620499669599, 552.5721180587861),
                                  (956.6325693810256, 551.2147556018499), (957.6056308534951, 550.8003251462906),
                                  (958.3755579703089, 551.2431756189872), (960.0751600203648, 551.2421191632774),
                                  (960.0751600203648, 551.2421191632774), (960.0751600203648, 551.2421191632774)])
        self.add_template(name='mirrored_C_shape',
                          points=[(647.7660618169488, 126.58785063993572), (646.5156283074327, 128.4992777036709),
                                  (648.1448057727365, 129.51193819963942), (647.8022430158949, 129.7720681821192),
                                  (648.731225707037, 126.0812110029883), (651.5756374726966, 120.63382872763471),
                                  (652.0816430014304, 115.63898976229947), (652.448765240216, 113.47534544689623),
                                  (653.0415495070588, 109.98175619047335), (652.7428171992628, 106.63594908628562),
                                  (653.9967717649207, 104.33145717954139), (651.0724779367476, 103.0571518491844),
                                  (652.3253864689996, 100.76014579649862), (654.8237055155694, 97.47263332705947),
                                  (657.1606356846421, 97.44628960783365), (657.3664224940337, 97.44396981668254),
                                  (655.994642670198, 97.22643214923725), (655.700966509025, 94.19052003690662),
                                  (658.3784744948833, 93.76521968238482), (661.1233540488995, 91.3525648005061),
                                  (663.5450736912569, 90.07292179052192), (666.4044981075953, 87.29482649680871),
                                  (667.7154411588068, 87.20728674341261), (670.0591551205197, 85.77110028746117),
                                  (671.8850359935628, 84.65223278789269), (676.9721707843318, 82.93952353461292),
                                  (682.5437666848919, 80.30884862050475), (685.4143522977475, 79.75229636678938),
                                  (689.3346938786412, 76.32972688379444), (689.4018280080641, 76.27111688313789),
                                  (692.2654529920954, 75.72382375520306), (697.8430137801604, 73.38086051238642),
                                  (702.0497480033434, 72.879826859358), (709.2408119361787, 73.69901711322292),
                                  (710.5056151200769, 73.57945401965674), (714.7616306053347, 73.17712867436886),
                                  (717.7316825465377, 74.86565995351647), (724.9688684689496, 75.71434319125352),
                                  (730.3777809921444, 75.07151159081894), (731.7380200450923, 75.26199956524985),
                                  (735.0150562878636, 75.72091595547502), (742.0588700302802, 78.09625650609206),
                                  (749.401468706248, 79.39436520576194), (752.6885063352444, 80.8617986561693),
                                  (754.9458571147808, 81.86954861740301), (762.3306035855527, 83.2198451917937),
                                  (768.100417694708, 85.52251605044272), (773.5837103819948, 86.69450474280139),
                                  (774.8141951787331, 86.95750625487462), (782.6253579693794, 89.24623872657212),
                                  (789.5942597172082, 91.93065651376256), (794.2627217159085, 93.52390973971845),
                                  (798.01146964181, 94.80328284544383), (806.7067588861303, 95.56204705790174),
                                  (812.1430960706944, 96.91739304915946), (815.5715434739648, 97.65366571919091),
                                  (820.837527176319, 98.78455659334463), (826.9288467958058, 102.061372264352),
                                  (836.3366581661081, 101.38018951353973), (836.3968994072814, 101.40021472584046),
                                  (843.3997470708986, 103.72808029505), (852.0697346648477, 106.43914613642738),
                                  (857.3706544705329, 107.0424661193708), (860.2859982441084, 107.37427365848153),
                                  (872.9231841824783, 111.3035354011558), (878.1403314902086, 113.42137218926746),
                                  (879.7338232994346, 114.06823059215994), (887.0197087878311, 116.55101314909618),
                                  (895.6549321260973, 119.28734291000454), (898.9502391639872, 119.71751589489132),
                                  (905.3025696517876, 120.54675606447327), (912.6967397687304, 126.62839210467799),
                                  (918.1617032949621, 128.62591969155665), (920.949499654892, 129.644901814462),
                                  (930.3718925380354, 132.96175042128624), (936.8343879407641, 135.99111286663273),
                                  (938.4030399192164, 136.6569637433926), (947.29936931085, 140.433218009306),
                                  (955.4859817119067, 143.49805719450242), (958.6908189007885, 144.61111571061397),
                                  (966.4746351759493, 147.31448018197372), (975.0957253923585, 148.68855267179555),
                                  (979.7901105101198, 149.82050415563253), (987.2217796069418, 151.6124936602229),
                                  (997.9508968727085, 155.5435306278013), (1000.5220164106709, 156.45374318467853),
                                  (1006.5263016691948, 158.57934479778473), (1016.8129083213836, 161.02533613599658),
                                  (1021.5082505016875, 162.26366222543575), (1027.8706386141735, 163.9416466807282),
                                  (1038.5935261329305, 168.22576479973472), (1042.163201302909, 169.08557444582448),
                                  (1048.7890924893177, 170.6815194225349), (1057.645793494605, 175.66748458907838),
                                  (1062.3150467438156, 176.86206974839737), (1066.285251665553, 177.8778098733872),
                                  (1078.264523129834, 183.12375111471792), (1082.2889881019703, 185.3989718020572),
                                  (1083.0445380909791, 185.82612000118777), (1094.1490593600495, 190.21699406081012),
                                  (1099.925504098469, 196.85494507398693), (1100.102962192642, 196.9235990746704),
                                  (1107.4995875464533, 199.78516436118048), (1115.8008950044282, 207.6545414755574),
                                  (1117.9557414297922, 208.77641153020633), (1123.8234443838485, 211.83129291583387),
                                  (1129.928028009908, 218.5232814330309), (1134.0201917712154, 223.08116228112291),
                                  (1134.2116975465838, 223.29446276389046), (1143.629328958789, 230.15955763611936),
                                  (1149.85062572526, 234.44608740079843), (1151.3547099371594, 236.1898064929639),
                                  (1154.337945353588, 239.64833927383899), (1162.071552668135, 243.4426389251561),
                                  (1166.5533156048177, 250.20714318942393), (1166.9646938200704, 250.49590278200765),
                                  (1174.2796306025064, 255.6304920401554), (1178.167537590003, 258.84312324390993),
                                  (1185.1121445639521, 262.4341328392424), (1186.9756968075103, 263.3977631804732),
                                  (1189.6139730659631, 267.41711166300007), (1193.7776648104375, 272.6167837219839),
                                  (1195.9465177502823, 276.28799022170176), (1199.0191403325587, 278.79815503137104),
                                  (1201.6174958412348, 280.9208695484456), (1202.7660282245342, 285.50362593107025),
                                  (1206.0834433130292, 289.0990249607648), (1209.8253467866582, 291.83586140456606),
                                  (1212.6973768211449, 294.8881206722346), (1214.604521302369, 296.9149446774507),
                                  (1216.463798305868, 301.35235764862557), (1221.5073086423224, 307.2499342675556),
                                  (1220.3949106234177, 311.0223264280658), (1220.8701692946831, 313.48843783921757),
                                  (1221.3588419519049, 316.02415425883265), (1224.4348207486778, 320.68753981731675),
                                  (1225.6100847027117, 327.1497365323972), (1228.1996232814884, 333.6100280919672),
                                  (1228.2242507810492, 333.70871976362395), (1229.0607803449107, 337.0610089736448),
                                  (1231.7957204892086, 342.7586439774379), (1232.945562456136, 348.81566622686614),
                                  (1234.531877910485, 354.455221914193), (1234.694988926562, 355.0351025778158),
                                  (1236.508580684467, 360.52996526268794), (1238.5063813421073, 365.7988234006092),
                                  (1236.9315129034135, 371.8847185888576), (1238.2725853779227, 375.10533909095983),
                                  (1239.1350686080657, 377.17661504846126), (1239.0393729763366, 382.4098508933034),
                                  (1240.314815908851, 386.07881014442944), (1235.6476585154273, 390.37466414134605),
                                  (1236.0167702247488, 394.45137269263097), (1236.0280090157723, 394.5755011727484),
                                  (1234.383828867846, 399.2724735288005), (1232.497567626537, 405.80492717670853),
                                  (1229.3349449255345, 409.7424879357815), (1226.468676285932, 413.6523430845051),
                                  (1225.538466890511, 414.92123461261457), (1222.8065573362658, 420.6109622045005),
                                  (1219.0454339942312, 425.56619914490324), (1213.7547637959028, 431.1508695772385),
                                  (1213.2671222394802, 431.6656091621387), (1211.10543869483, 436.30349037018505),
                                  (1205.9975460071869, 441.0801588913904), (1200.948454660428, 446.7162728634532),
                                  (1199.8253178739249, 447.5727420160655), (1194.8333284621197, 451.37947775187024),
                                  (1187.7573755747824, 458.5636055487831), (1182.9147286822895, 461.03586666793507),
                                  (1179.8511810640164, 462.599864587145), (1174.9275956293227, 466.57777440173396),
                                  (1166.0118051340928, 472.1504931800436), (1165.1926823434617, 473.425217457373),
                                  (1162.3421110231038, 477.86129530538307), (1151.299668699128, 481.51384889218514),
                                  (1147.7937733367198, 484.92978383910105), (1146.0556434647367, 486.62331372469004),
                                  (1139.8016971457835, 491.2930454107254), (1129.9963685677365, 495.7686551132029),
                                  (1129.3137534846273, 496.16331776364285), (1121.6877123902702, 500.5724110654702),
                                  (1113.3843594988618, 505.4001497669695), (1110.2723955505205, 506.7320712165725),
                                  (1105.135605744657, 508.9306187055876), (1096.8093927193743, 513.4531288099013),
                                  (1091.199878696895, 516.7300192382697), (1090.9943870914262, 516.8531293975345),
                                  (1083.1574342502938, 521.5482531239838), (1073.0241907190666, 526.522869659602),
                                  (1071.8181413772172, 527.1822229517593), (1065.7252984429178, 530.5132110862642),
                                  (1054.0666812506831, 533.307724765387), (1051.5017093103024, 534.5862320429178),
                                  (1044.9811057414252, 537.8364193005084), (1033.657643774888, 542.0311485565809),
                                  (1031.6782653133048, 543.4537160693594), (1026.2794299245322, 547.333826912217),
                                  (1016.2568177823615, 552.4621511003468), (1012.8113175175379, 554.2717221349777),
                                  (1008.9568305677589, 556.2960922994189), (998.3657140424797, 561.0122338470593),
                                  (993.5222605342699, 564.2953110026432), (991.8254344924651, 565.4454842840438),
                                  (982.068074890446, 569.8323904901697), (974.8847174191347, 575.1642709991684),
                                  (974.797402373364, 575.2220997359802), (968.4677291283285, 579.4142410211526),
                                  (963.5619051588554, 584.8518948750427), (957.5786055834093, 588.2544432998665),
                                  (956.3839842768971, 588.9337936806187), (947.4470701017823, 593.5862494926135),
                                  (943.2467057785344, 597.0817978222071), (938.955343115493, 599.4146211314044),
                                  (934.7840513704938, 601.6821728105018), (929.2886395669102, 605.1284961070904),
                                  (924.2235349519204, 609.2058366590169), (920.660867959189, 611.1570353537883),
                                  (915.8547524913457, 613.7892449447797), (912.2960872013052, 617.8301623972125),
                                  (906.3122697211871, 619.8150031676076), (902.078195863779, 621.6885766983632),
                                  (899.9056412224269, 622.6499299971574), (894.7058762412115, 625.7026557234957),
                                  (888.0135990491007, 627.6756595088003), (883.9915212835574, 629.596126356964),
                                  (882.0840030867442, 630.0432856273267), (876.8173348273458, 631.2778948384207),
                                  (871.4438008051636, 632.7115084968666), (863.9073521983078, 635.7041301537829),
                                  (861.3654567021462, 636.6692153292261), (858.503857455598, 637.7556828945029),
                                  (853.9716529293152, 637.5943092984895), (846.4013497740593, 640.2866677603263),
                                  (840.4367353298326, 641.857275685763), (839.8897785735096, 642.001300856943),
                                  (834.4722847992416, 642.3636141032703), (831.9225724859357, 641.7531055537102),
                                  (823.574185396986, 642.1741879917308), (819.0727001030739, 640.4434036654661),
                                  (818.0707343531313, 640.0581560189171), (811.16990631721, 639.0221899292612),
                                  (805.9442347587691, 639.0744087714517), (803.2837321763419, 637.4398256008748),
                                  (797.9152695461585, 636.8696789853984), (795.0855213360469, 636.5691513528553),
                                  (791.0184901854387, 634.604742504444), (784.8319805986301, 631.9559910441342),
                                  (781.1634526348063, 630.8648818005722), (777.4122064341477, 629.875860764866),
                                  (776.2736399778519, 629.5756762086969), (768.7966385912111, 628.637666023837),
                                  (763.0465328557008, 626.4494461227625), (760.911065676553, 625.8557834689012),
                                  (756.4402712674371, 625.7298877806128), (756.1993332805293, 625.7698978743256),
                                  (751.3645647958973, 626.5727581564773), (746.7627017715259, 625.2174534656588),
                                  (740.1081693719926, 625.7398214413455), (736.0602056077395, 626.0535630528077),
                                  (734.7299454847043, 626.3611781959787), (729.5189858345178, 627.566183195447),
                                  (727.025121549558, 629.1505582358458), (725.1737574610098, 628.3929307361203),
                                  (723.08134747858, 631.4080499182085), (724.2580768290148, 631.4184047358287),
                                  (723.3317733287084, 633.8908590911757), (721.9217364787793, 634.6403362606407),
                                  (721.9217364787793, 634.6403362606407), (722.3975202038613, 637.004292069048)])

    def distance(self, p1, p2):
        dx = p1[0] - p2[0]
        dy = p1[1] - p2[1]
        return math.sqrt(dx * dx + dy * dy)

    def total_length(self, point_list):
        p1 = point_list[0]
        length = 0.0
        for i in range(1, len(point_list)):
            length += self.distance(p1, point_list[i])
            p1 = point_list[i]
        return length

    def resample(self, point_list, step_count=64):
        new_points = []
        length = self.total_length(point_list)
        step_size = length / step_count
        current_pos = 0
        new_points.append(point_list[0])
        i = 1
        while i < len(point_list):
            p1 = point_list[i - 1]
            d = self.distance(p1, point_list[i])
            if current_pos + d >= step_size:
                nx = p1[0] + ((step_size - current_pos) / d) * (point_list[i][0] - p1[0])
                ny = p1[1] + ((step_size - current_pos) / d) * (point_list[i][1] - p1[1])
                new_points.append((nx, ny))
                point_list.insert(i, (nx, ny))
                current_pos = 0
            else:
                current_pos += d
            i += 1

        # hack for umatching lengths
        if len(new_points) < step_count + 1:
            for x in range((step_count + 1) - len(new_points)):
                new_points.append((nx, ny))
        return new_points

    def rotate(self, points, center, angle_degree):
        new_points = []
        angle_rad = angle_degree * (np.pi / 180)  # degrees multmat
        rot_matrix = np.matrix([[np.cos(angle_rad), -np.sin(angle_rad), 0],  # clockwise
                                [np.sin(angle_rad), np.cos(angle_rad), 0],
                                [0, 0, 1]])

        t1 = np.matrix([[1, 0, -center[0]],
                        [0, 1, -center[1]],
                        [0, 0, 1]])

        t2 = np.matrix([[1, 0, center[0]],
                        [0, 1, center[1]],
                        [0, 0, 1]])

        transform = t2 @ rot_matrix @ t1

        for point in points:
            hom_point = np.matrix([[point[0]], [point[1]], [1]])
            rotated_point = transform @ hom_point
            new_points.append((float(rotated_point[0]), float(rotated_point[1])))
        return new_points

    def centroid(self, points):
        xs, ys = zip(*points)
        return sum(xs) / len(xs), sum(ys) / len(ys)

    def angle_between(self, point1, point2):  # point2 is our centroid
        dx = point2[0] - point1[0]
        dy = point2[1] - point1[1]
        return math.atan2(dy, dx) * 180 / math.pi  # degree

    def scale(self, points):
        size = 100
        xs, ys = zip(*points)
        x_min, x_max = min(xs), max(xs)
        y_min, y_max = min(ys), max(ys)
        x_range = x_max - x_min
        y_range = y_max - y_min
        points_new = []
        for p in points:
            p_new = ((p[0] - x_min) * size / x_range,
                     (p[1] - y_min) * size / y_range)
            points_new.append(p_new)
        return points_new

    def normalize(self, points):  # put everything together
        points_new = self.resample(points)
        angle = -self.angle_between(points_new[0], self.centroid(points_new))
        # points_new = self.rotate(points_new, self.centroid(points_new), angle)
        points_new = self.scale(points_new)
        return points_new

    def add_template(self, name, points):
        points = self.normalize(points)
        gesture = GestureTemplate(name, points)
        self.gestures.append(gesture)

    def gesture_distance(self, gesture, template):
        total_distance = 0
        if len(gesture) == len(template):
            for p1, p2 in zip(gesture, template.points):
                total_distance += self.distance(p1, p2)

            return total_distance

        else:
            raise Exception("Length of gesture isn't matching template")

    def get_gesture(self, points):
        points = self.normalize(points)
        smallest_distance = 1000000
        recognized_template = None
        for template in self.gestures:
            current_distance = self.gesture_distance(points, template)
            print(current_distance)
            if current_distance < smallest_distance:
                smallest_distance = current_distance
                recognized_template = template

        return recognized_template
